<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=0">
    <meta http-equiv='cache-control' content='no-cache'> 
    <meta http-equiv='expires' content='0'> 
    <meta http-equiv='pragma' content='no-cache'> 
	<title>学生端主页</title>
	<link rel="stylesheet" type="text/css" href="css/common.css" />
	<link rel="stylesheet" type="text/css" href="css/swiper-3.4.2.min.css" />
	<link rel="stylesheet" type="text/css" href="iconfont/iconfont.css" />
	<link rel="stylesheet" type="text/css" href="css/commonUI.css" />
	<link rel="stylesheet" type="text/css" href="css/animate.css" />
	<link rel="stylesheet" type="text/css" href="css/index.css" />
	<link rel="stylesheet" type="text/css" href="css/index1.css" />
	<link rel="stylesheet" type="text/css" href="css/mobileSelect.css" />
	<link rel="stylesheet" href="css/weui.min.css" />
	<link rel="stylesheet" type="text/css" href="./css/common.css" />
	<link rel="stylesheet" type="text/css" href="./iconfont/iconfont.css" />
	<link rel="stylesheet" type="text/css" href="./css/commonUI.css" />
	<link rel="stylesheet" type="text/css" href="./css/index.css" />
	<link rel="stylesheet" type="text/css" href="./css/index1.css" />
	<link rel="stylesheet" type="text/css" href="./css/mobileSelect.css" />
	<link rel="stylesheet" href="css/weui.min.css" />
	<link rel="stylesheet" type="text/css" href="./css/simplePagination.css" />
    <link rel="stylesheet" href="./css/History.min.css" />

	<script src="js/const.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/resize.js" type="text/javascript" charset="utf-8"></script>
	<link rel="stylesheet prefetch" href="css/photoswipe.css">
	<link rel="stylesheet prefetch" href="css/default-skin/default-skin.css">
	<script src="js/photoswipe.js"></script>
	<script src="js/photoswipe-ui-default.js"></script>
	<style type="text/css">
		.studentCourse img {
			width: 4rem;
			display: block;
			margin: auto;
		}

		.p_card a {
			position: absolute;
			bottom: 0.28rem;
			right: 1.2rem;
		}

		._news {
			position: absolute;
			top: 0;
			z-index: 22;
			right: -0.35rem;
    display: none;

		}

		.video button {
			width: 2.5rem;
			height: 0.9rem;
			background-color: #F3BA1B;
			border: 0;
			border-radius: 0.2rem;
			color: white;
			display: block;
			margin: 0.5rem auto;
			display: none;
		}

		.video header {
			font-size: 0.28rem;
			font-weight: 900;
			margin-top: 0.4rem;
			padding: 0 0.5rem;
		}

		.changeInformation {
			display: none;
			width: 6.5rem;
			position: fixed;
			z-index: 1111;
			top: 25%;
			left: 0.5rem;
			background-color: #fff;
			padding: 0.5rem;
			border-radius: 0.2rem;
		}

		.changeInformation i {
			position: absolute;
			top: 0.3rem;
			right: 0.5rem;
			font-size: 0.3rem;

		}

		.changeInformation p {
			line-height: 0.42rem;
		}

		.changeInformation button {
			width: 2rem;
			height: 0.6rem;
			border-radius: 0.6rem;
			border: 0;
			color: white;
			background-color: #EFB511;
			box-shadow: 2px 5px 2px #eee;
			margin-top: 0.2rem;
		}

		.new_icon {
			margin: 0.1rem 0 0.2rem 0;
		}

		.new_icon i {
			font-size: 0.35rem;
			float: right;
			margin-right: 0.5rem;
			font-weight: bolder;
		}

		.text {
			background-color: #eee;
			margin-right: 0.5rem;
		}

		.text .list {
			border-bottom: 1px solid #fff;
			padding: 0.2rem;
		}

		.text .list p {
			margin-top: 0.1rem;
			line-height: 0.37rem;
			font-size: 0.24rem;
			/*text-indent: 2em;*/
		}

		.text .blue {
			color: #2200D1;
		}

		.input {
			position: fixed;
			bottom: 0;
			width: 100%;
			background-color: #eee;
			padding: 0.2rem;
			padding-top: 0.3rem;
		}

		.text p:hover {
			background-color: #ddd;
		}

		.input input {
			font-size: 0.3rem;
			width: 5.5rem;
			background-color: #eee;
			border: 0;
			padding-left: 0.16rem;
			outline: none;
			border-bottom: 1px solid #51C332;
			padding-bottom: 0.05rem;
		}

		.input button {
			background-color: #eee;
			border: 1px solid #A4A4A4;
			color: #A4A4A4;
			float: right;
			font-size: 0.3rem;
			padding: 0.05rem 0.1rem;
		}

		.input button.on {
			background-color: #51C332;
			border: 1px solid #51C332;
			color: white;
		}

		.class {
			/* width: 25%;
			padding: 0.3rem; */
			/* text-align: center; */
			border-right: 1px solid #aaa;
		}

		.warp-ks {
			background: #f4f4f4;
		}

		.item {
			background-color: #f8bf84;
			border-radius: 5px;
			width: 1.5rem;
			height: 0.5rem;
			text-align: center;
			line-height: 0.5rem;
			margin-left: 0.5rem;
			margin-top: 0.2rem;
		}

		.hour {
			color: #373cef;
			text-decoration: underline
		}

		input::-webkit-input-placeholder {
			/* placeholder颜色  */
			color: #A4A4A4;
			/* placeholder字体大小  */
			/*font-size: 12px;
         /* placeholder位置  */
			/*text-align: right;*/
		}

		.hideTime {
			padding-left: 1rem;
			/*display: flex;justify-content: flex-start;padding-right: 0.5rem;*/
		}

		.hideTime p {
			/*padding-left: 1.3rem;*/
			line-height: 0.4rem;
		}

		.hideTime b {
			margin-right: 0.1rem;
		}

		.plok-cont {
			width: 6.5rem;
			margin: 0 auto;
			display: flex;
			text-align: center;
			box-shadow: 2px 2px 8px #aaa, -2px 2px 8px #aaa;
			position: relative;
			z-index: 1;
			margin-top: -11px;
			background: #fff;
			border-radius: 5px;
			padding: 0.2rem;
		}

		.restofclass {
			width: 50%;
		}

		.currency {
			width: 50%;
			border-left: 1px solid #ccc;
		}

		.hide-top {
			width: 7.5rem;
			height: 3.2rem;
			background: #f8bf84;
			display: flex;
			justify-content: space-evenly;
			padding-top: 0.2rem;
		}

		.tux {
			width: 1rem;
		}

		.figure {
			width: 3rem;
		}

		.message {
			line-height: 0.5rem;
		}

		#swiper-con {

			width: 100%;

			height: 150px;
			margin-left: 0rem;
			margin-right: auto;
			position: relative;
			overflow: hidden;
			z-index: 1;
		}

		.swiper-slide {

			width: 100%;

			height: 150px;

		}

		.swiper-slide img {

			width: 80%;

			height: 100%;
			margin-left: 0.75rem;

		}

		.zwju {
			margin-left: 0.6rem;
			margin-top: 0.3rem;
			font-size: 0.26rem;
			display: none;
			color: #ccc;
		}

	.cro{
		width: 0.5rem;
    height: 0.5rem;

	}
	.tup{
		position: absolute;
    bottom: 15px;
    right: 10px;
    width: 1rem;
    text-align: center;
	}
	</style>
</head>

<body class="up-page">
	<div class="float1" style="opacity: 0;"></div>
	<div class="input" style="z-index: 1111;position: fixed;display: none;">

		<input type="text" name="" id="" value="" placeholder="评论" /><button class="">发送</button>
	</div>
	<div class="up-page-wrapper child">
		<div class="header">
			<div class="hide-top">
				<div class="name">
					<img src="./凤凰币/img/头像.png" alt="" class="tux">
				</div>
				<div class="message">
					<div>
						<span style="font-size: 0.5rem;" class="p_card-name"></span>
						<a href="javascript:void(0)" class="bj-info">学生信息编辑</a>

					</div>

					<p class="p_card-class"></p>
					<p class="p_card-birthday"></p>
					<p class="p_card-tel"></p>
				</div>
					<div style="display:flex;position: relative;">
					<img src="./凤凰币/img/人物.png" alt="" class="figure">
					<div  class="tup">
						<img src="./img/qc.png" alt="" class="cro">
						<p style="font-size: 12px;
						color: #221f1f;">清除缓存</p>
					</div>
				</div>
			</div>

			<!-- <div class="p_card ">
				<div class="name">
					<p></p> <img src="img/default_person.png" alt="" />
				</div>
				<div class="class"></div>
				<div class="birthday">生日:<span></span></div>
				<div class="tel"></div>
				<a href="person_edit/userInfo.html">修改头像</a>
				<img class="more" onclick="goUrl('changeCard.html?type=2')" src="img/moreCards.png" />
			</div> -->
		</div>
		<div class="plok-cont">
			<div class="restofclass">
				<p class="plom">0</p>
				<p>剩余总课时</p>
			</div>
			<div class="currency">
				<p class="plvb">0</p>
				<p>凤凰币</p>
			</div>
		</div>




		<div class="">
			<!-- <header
				style="font-size: 0.28rem;font-weight: 900;margin-top: 0.4rem;margin-bottom: 0.2rem;padding: 0 0.5rem;">
				课时信息</header> -->
			<!-- <div class="hideTime">
				<div class="courseText">
					
						
					
				</div>

				<p style="padding-left: 0;">消耗课时：<a href="javascript:void(0)" class="consume">111</a>&ensp;</p>
				<p style="padding-left: 0;">已报常规课课时：<a href="javascript:void(0)"
						class="consume1">111</a>&ensp;剩余常规课时：<span class="keshi"></span></p>
			</div> -->
			<!-- <div class="" style="margin-left: 0.9rem;">&ensp;已报试听课课时：<span class="keshi3"></span>&ensp;剩余试听课时：<span class="keshi1"></span></div> -->
		</div>
		<!--<div class="video">
			<button>观看学习视频</button>
			<header>下节课课程时间:
				<div id="time" style="margin-top: 0.2rem;text-align: center;background: #ccc;
				border-radius: 5px;">

				</div>
			</header>
		</div>-->

		<div class="share">
			<!-- <header><img src="img/bodyBg/defined.jpg" alt="" />
				<div class="name"></div><time></time>
			</header>
			<p></p>
			<div class="imgLists">

			</div>
			<div class="new_icon">
				<img style="width: 0.55rem;float: right;margin-right: 0.5rem;" src="img/news.png" />
				<div class="clearfix"></div>
			</div>
			<div class="text">
				<div class="list">可乐老师
					<p>王文小朋友在课上比上节课进步了很多，要加油继续努力啊！！</p>
				</div>

			</div> -->
		</div>

		<div class="changeInformation">
			<i class="iconfont icon-guanbi"></i>
			<header style="text-align: center;">学生信息确认</header>
			<p>姓名：<span></span></p>
			<p>性别：<span></span></p>
			<p>出生年月：<span></span></p>
			<p>所在学校：<span></span></p>
			<p>所在班级：<span></span></p>
			<p>联系方式：<span></span></p>
			<div class="" style="display: flex;justify-content: space-around;">
				<button>确定</button>
				<button style="background-color: #999999;">去修改</button>
			</div>
		</div>
		<div class="float"></div>
		<div class="t_card animated card1 zoomIn" style="display: none;">
			<div class="name"> <img src="img/bodyBg/defined.jpg" alt="" /><span></span></div>
			<div class="class"></div>
			<div class="tel"></div>
		</div>
		<!-- Root element of PhotoSwipe. Must have class pswp. -->
		<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

			<!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
			<div class="pswp__bg"></div>

			<!-- Slides wrapper with overflow:hidden. -->
			<div class="pswp__scroll-wrap">

				<!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
				<div class="pswp__container">
					<div class="pswp__item"></div>
					<div class="pswp__item"></div>
					<div class="pswp__item"></div>
				</div>

				<!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
				<div class="pswp__ui pswp__ui--hidden">

					<div class="pswp__top-bar">

						<!--  Controls are self-explanatory. Order can be changed. -->

						<div class="pswp__counter"></div>

						<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

						<!--<button class="pswp__button pswp__button--share" title="Share"></button>-->

						<!--<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>-->

						<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

						<!-- element will get class pswp__preloader--active when preloader is running -->
						<div class="pswp__preloader">
							<div class="pswp__preloader__icn">
								<div class="pswp__preloader__cut">
									<div class="pswp__preloader__donut"></div>
								</div>
							</div>
						</div>
					</div>

					<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
						<div class="pswp__share-tooltip"></div>
					</div>

					<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
					</button>

					<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
					</button>

					<div class="pswp__caption">
						<div class="pswp__caption__center"></div>
					</div>

				</div>

			</div>

		</div>
		<div class='up-page'>
			<div class="up-page-wrapper informalStudentBox">

				<div class="item">上课记录</div>
				<p class="zwju">暂无记录</p>
				<div class="_center"></div>
				<div class="_bottom">
					<div class="content">
						<div class="appointmentrecord_content" style="display: block;">
							<div class="clearFix"></div>
							<div class="list"></div>
						</div>
					</div>
				</div>
				<div class="zhuanrang1" style="display:none"></div>
			</div>
		</div>
</body>
<script src="js/jquery-1.7.2.js" type="text/javascript" charset="utf-8"></script>
<script src="js/swiper-5.2.0.min.js" type="text/javascript" charset="utf-8"></script>
<script src="js/commonUI.js" type="text/javascript" charset="utf-8"></script>
<script src="js/utils.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
var uid =localStorage.getItem("zhizhao_uid") || localStorage.getItem("uid")

	$('.currency').click(function () {
		window.location.href = './凤凰币/html/凤凰币兑换.html';


	})


		$('.tup').click(function(){
			if( localStorage.removeItem("zhizhao_uid") == undefined  && localStorage.removeItem("uid") == undefined){
				console.log(999)
				window.location.href="./lusilogin.html"
			}
		})





	var mySwiper = new Swiper('.swiper-container', {

		// 轮播图的方向，也可以是vertical方向

		direction: 'horizontal',
		//播放速度
		loop: true,
		pagination: {

			el: '.swiper-pagination',

		},
		  // 如果需要前进后退按钮
		  navigation: {
      nextEl: '.swiper-button-next',
      prevEl: '.swiper-button-prev',
    },

		// 这样，即使我们滑动之后， 定时器也不会被清除

		autoplayDisableOnInteraction: false,

	});


	//$('.currency').click(function () {
		//window.location.href = './凤凰币/html/凤凰币兑换.html';


	//})
	$('.restofclass').click(function () {
			window.location.href = './凤凰币/html/gb.html';

	})


console.log(uid)

	var ui = window.CUMS.UI;
	var studentclassid = 0 /*学生上课记录表id*/ ,
		userid /*评论人*/ , content /*评价内容*/ , type /*1为老师 2为学生*/ , parent = 0,
		huiparentid = 0 /*父级id,为0则是评论  否则为回复*/ ,
		_curriculumid;
	//	ui.showToast( '板块正在开发！');
	$(".video button").click(function () {
		ui.showToast('暂时没有权限观看');
	})
	getAjax(FenghuangConst.hostAjax + "/api/stu/v1/getmessagelist", { //所有的消息
		user_id: uid,
		type: localStorage.getItem("zhizhao_typle")
	}, function (data) {
		if (data.Code == 1000) {
			$(".ifHite").removeClass("hite");
			return false;
		}
	})
	var items = [],
		pswpElement, options = {},
		gallery = undefined;
	//设置自己的卡片背景
	if (localStorage.getItem("cardClass")) {
		$(".p_card").addClass(localStorage.getItem("cardClass"));
	}
	if (sessionStorage.getItem("firstlogin")) {
		$(".changeInformation").show();
		$(".float").fadeIn();
	}

	function showTeacherCard() {
		$(".float").show();
		$(".t_card").show();
	}
	$(".float").click(function () {
		$(this).fadeOut();
		$(".t_card").fadeOut();
	})
	getAjax(FenghuangConst.hostAjax + "/api/stu/v1/studentinfo", { //学生信息--昵称、名字、电话、头像
		user_id: uid
	}, function (data) {
		console.log(data.Data)
		if (data.Data != "") {
      //显示剩余总课时
      if(data.Data[0] && data.Data[0].classhour) {
        $('.plom').text(data.Data[0].classhour)
      }
		  
			if (data.Data[0].nowschool == "") {
				data.Data[0].nowschool = "未填";
			}
			if (data.Data[0].nowgrade == "") {
				data.Data[0].nowgrade = "未填";
            }
            if(data.Data.length > 0) {
                $(".changeInformation p").eq(0).find("span").text(data.Data[0].name);
                $(".changeInformation p").eq(1).find("span").text(data.Data[0].sex);
                $(".changeInformation p").eq(2).find("span").text(data.Data[0].birthday);
                $(".changeInformation p").eq(3).find("span").text(data.Data[0].nowschool);
                $(".changeInformation p").eq(4).find("span").text(data.Data[0].nowgrade);
                $(".changeInformation p").eq(5).find("span").text(data.Data[0].phone);
            }
			
			$(".changeInformation div button").eq(0).click(function () {
				ui.showAlert('是否确认', function () {
					$(".changeInformation").fadeOut();
					$(".float").fadeOut();
					sessionStorage.removeItem("firstlogin");
				}, null, "确认", "取消", "提示");

			})
			$(".consume").text(parseFloat(data.Data[0].consumeclasshour) + "课时");
			$(".changeInformation>i").eq(0).click(function () {
				ui.showAlert('是否确认', function () {
					$(".changeInformation").fadeOut();
					$(".float").fadeOut();
					sessionStorage.removeItem("firstlogin");
				}, null, "确认", "取消", "提示");
			})
			$(".changeInformation div button").eq(1).click(function () {
				location.href = "src/zheEnd/newStudent.html";
			})
			//			$(".float").show();
			$(".p_card-name").text(data.Data[0].name);
			localStorage.setItem("zhizhao_Name", data.Data[0].name);
			if (data.Data[0].sex == "男") {
				// $(".p_card .name img").attr("src","img/cardBg/boy@3x.png");
			} else if (data.Data[0].sex == "女") {
				$(".p_card .name img").attr("src", "img/cardBg/girl@3x.png");
			}
			if (data.Data[0].imgurl != "") {
				$(".p_card .name img").attr("src", data.Data[0].imgurl);
			}
			$(".p_card-class").text(data.Data[0].nowgrade);
			if (data.Data[0].nowgrade == "") {
				$(".p_card .class").hide();
			}
			$(".p_card-birthday").text(data.Data[0].birthday);
			if (data.Data[0].birthday == "暂无") {
				$(".p_card .birthday").hide();
			}

			$(".p_card-tel").text(data.Data[0].phone);
			$(".bj-info").click(function () {
				$(".changeInformation").show();
				$(".float").fadeIn();
			})
		}
    })

    //获取剩余课时和凤凰币
    function tup1() {
		// getAjax(
		// 	hostAjax + '/api/phoenixcoin/v1/getstudnetclasshour', {
		// 		//查看所有老师
		// 		user_id: uid
		// 	},
		// 	function (data) {
		// 		console.log(data)

		// 		$('.plvb').text(data.Data.list[0].integral)
		// 		$('.plom').text(data.Data.sumremainingclasshour)
		// 	}
		// )
	}

	tup1()

	function cl() {


		$.ajax({
			url: FenghuangConst.hostAjax + '/api/stu/v1/sharearticle',
			data: {
				user_id: uid
			},
			success: function (data) {
				console.log(data.Msg)
			}
		})

	}



	function but1() {
		$.ajax({
			// type:'get',
			url: FenghuangConst.hostAjax + '/api/other/v1/banner',
			data: {
				t: 0
			},
			success: function (data) {
				console.log(data)
				html = ''
				for (var i = 0; i < data.Data.length; i++) {
					html += `

<div class="swiper-slide">
	<a href="${data.Data[i].bannerurl}"  class='pl'><img src="${data.Data[i].images}" /></a>
	</div>`
				}
				$('.swiper-wrapper').html(html)
				console.log(data)
				$('.pl').click(function () {
					//cl()
				})
			}

		})
	}

	but1()








	//课程信息
	getAjax(FenghuangConst.hostAjax + "/api/tch/v1/getstudentsinginfo", {
		user_id: uid
	}, function (data) {
		console.log(data)
		var str = "",
			xufeiStr = "";
		if (data.Data != "") {

			if (data.Data.list[0].syclasshour <= 0) {
				data.Data.list[0].syclasshour = 0;
			}
			var shengyuStr = "";

			for (var i = 0; i < data.Data.listtype.length; i++) {
				if (data.Data.listtype[i].classhour < 0) {
					data.Data.listtype[i].classhour = 0;
				}
				if (data.Data.listtype[i].classhour != 0) {
					shengyuStr += '<p>剩余' + data.Data.listtype[i].typename + '课时：<b class="">' + data.Data
						.listtype[i].classhour + '</b>课时</p>'
				}

			}
			$(".courseText").html(shengyuStr);
			$(".classhour").text(parseFloat(data.Data.list[0].syclasshour));
			$(".hideTime b").each(function () {
				if ($(this).text() == 0) {
					$(this).parent("p").remove();
				}
			})
			if ($(".hideTime b").length == 0) {

				$(".hideTime").prepend('剩余常规课课时：<b class="classhour">0</b>课时');
			}
			$("b").each(function () {
				if ($(this).text() <= 8) {
					$(this).css("color", "red");

					$(this).css("font-size", "0.3rem");
				}
			})
			$(".consume").text(parseFloat(data.Data.list[0].consumeclasshour) + "课时");
			$(".consume").click(function () {
				location.href = "consume.html?studentId=" + uid;
				console.log(111)
			})

		}
	})
	getAjax(FenghuangConst.hostAjax + "/api/stu/v1/getnextsectioncourseInfo", { //我的课程
		user_id: uid
	}, function (data) {

		if (data.Data != "") {
			$("#time").text(data.Data.classtime);
			if (new Date() > new Date(data.Data.classtime.replace("年", "/").replace("月", "/").replace("日", "")
					.split("-")[0] + ":00") && new Date() < new Date(data.Data.classtime.replace("年", "/").replace(
						"月", "/").replace("日", "").split(" ")[0] + " " + data.Data.classtime.replace("年", "/")
					.replace("月", "/").replace("日", "").split("-")[1] + ":00")) {
				//才可以观看
				ui.showAlert('您的孩子在上课。是否查看直播', function () {
					location.href = "video.html?classRoomId=" + data.Data.classroomid;
					sessionStorage.setItem("endTime", new Date(data.Data.classtime.replace("年", "/")
						.replace("月", "/").replace("日", "").split(" ")[0] + " " + data.Data
						.classtime.replace("年", "/").replace("月", "/").replace("日", "").split("-")[
							1] + ":00").getTime() + 600000);
				}, null, "这就去", "取消", "提示");
			} else {

			}
			$(".video button").unbind();
			$(".video button").click(function () {

				if ((new Date().getTime() + 600000) > new Date(data.Data.classtime.replace("年", "/")
						.replace("月", "/").replace("日", "/").split("-")[0]) && new Date() < new Date(data
						.Data.classtime.replace("年", "/").replace("月", "/").replace("日", "/").split(" ")[
							0] + data.Data.classtime.replace("年", "/").replace("月", "/").replace("日", "/")
						.split("-")[1])) {
					//才可以观看
					location.href = "video.html?classRoomId=" + data.Data.classroomid;
					sessionStorage.setItem("endTime", new Date(data.Data.classtime.replace("年", "/")
						.replace("月", "/").replace("日", "").split(" ")[0] + " " + data.Data
						.classtime.replace("年", "/").replace("月", "/").replace("日", "").split("-")[
							1] + ":00").getTime() + 600000);
				} else {
					//					location.href="video.html?classRoomId=7";
					ui.showToast('暂时没有权限观看');
				}
			})
		} else if (data.Code == 1000) {
			$("#time").parent("header").hide();
		}
	})

	function initData() {
		//初始化学员信息
		//   getStudent()
		//初始化记录
		getRecord()
	}
	initData()
	// 获取记录
	function getRecord(type) {
		//   $.showLoading()
		let url = ''
		let data = {}
		url = '/api/stu/v1/getstudetnclassroominfos'
		data = {

			user_id: uid
		}

		getAjax(FenghuangConst.hostAjax + url, data, function (data) {
			// hideLoading()
			if (data.Data != '') {
				console.log(data)
				let html = ''
				for (let i = 0; i < data.Data.length; i++) {
					const element = data.Data[i]
					html += `
                  <div class="list-item">
                      <div>
                        <div class="left">
                          <div class="header_pic_box">
                            <img
                              class="header_pic"
                              src="${
                                element.imgurl
                                  ? element.imgurl
                                  : './img/default_person.png'
                              }"
                              alt=""
                              srcset=""
                            />
                          </div>
                          <div class="name">${element.teachername}</div>
                          <div class="time">${element.dateweek}</div>
                        </div>
                        <div class="right"><div></div></div>
                      </div>

                      <div>
                        <div>
                          <div>
                            ${element.principalsevaluation}
                          </div>
                          
                        </div>
                        <img id='intro' class='min' src=" ${element.imgurllist}" alt="" style=' width: 100px;
    margin-top: 0.2rem;'>
                      </div>
                    </div>`
				}
				$('.appointmentrecord_content .list').html(html)
			} else {
				$('.zwju').css({
					'display': 'block'
				})
			}
			// $("#intro").click(function(){
			//   $(this).toggleClass('max')
			// })

		})
	}

	function courseHistory(curriculumid) {

		getAjax(FenghuangConst.hostAjax + "/api/stu/v1/getstudetnclassroominfo", { //学习历史
			user_id: uid, //学生id
			curriculumid: curriculumid
		}, function (data) {
			if (data.Data != "") {
				$(".laoshi a").text(data.Data.list[0].nickname);
				$(".laoshi a").attr('id', data.Data.list[0].teacherid);
				console.log(data.Data.list[0].teacherid);
				$(".share time").text(data.Data.list[0].classroomtime);
				$(".share header img").text(data.Data.list[0].teacherimg);
				$(".share>p").text(data.Data.list[0].principalsevaluation);
				$(".share .name").text(data.Data.list[0].teachername);

				var imgurllist = data.Data.list[0].imgurllist.split("|");
				var imgStr = "";

				for (var j = 0; j < imgurllist.length; j++) {
					imgStr += '<div class="wrap" index=' + j + ' style="background-image: url(' + imgurllist[j] +
						');"><img class="item" src="' + imgurllist[j] +
						'"/><span class="w"></span><span class="h"></span></div>';
				}
				if (data.Data.list[0].imgurllist != "") {
					$(".share .imgLists").html(imgStr);
					$(".item").each(function (i) {
						var _this = this;
						$(this)[0].onload = function () {
							$(_this).parent("div").find('.w').text(parseInt($(this).css("width")));
							$(_this).parent("div").find('.h').text(parseInt($(this).css("height")));
						}
					})
					pswpElement = document.querySelectorAll('.pswp')[0];
					options = {
						index: 0 // start at first slide
					};
					gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, options);
					$(".imgLists>div").click(function () {

						items = [];
						var _this = this;

						for (var z = 0; z < $(_this).parent(".imgLists").find(".wrap").length; z++) {
							items.push({
								src: $($(_this).parent(".imgLists").find(".wrap")[z]).find("img")
									.attr("src"),
								w: parseInt($($(_this).parent(".imgLists").find(".wrap")[z]).find(
									".w").text()),
								h: parseInt($($(_this).parent(".imgLists").find(".wrap")[z]).find(
									".h").text())
							})
						}
						options = {
							index: parseInt($(this).attr("index")) // start at first slide
						};
						gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, options);
						gallery.init();
					})
				}

				$(".laoshi a").click(function () {
					getAjax(FenghuangConst.hostAjax + "/api/tch/v1/teacherinfo", { //老师的名片
						user_id: $(this).attr('id')
					}, function (data) {
						if (data.Data != "") {
							$(".t_card .name span").text(data.Data.nickname);
							if (data.Data.imgurl != "") {
								$(".t_card img").attr("src", data.Data.imgurl);
							}
							$(".t_card .class").text(data.Data.name);
							$(".t_card .tel").text(data.Data.phone);
						}
					})
				})

			} else {
				$(".share").hide();
				//			$(".main header span").hide();
			}
		})
		go(curriculumid);
	}

	function go(curriculumid) {
		_curriculumid = curriculumid;
		var ajaxdata = {
			user_id: uid,
			curriculumid: curriculumid //课程id
		}
		var str = "",
			textStr = "";

		getAjax(FenghuangConst.hostAjax + "/api/stu/v1/getstudetnclassroominfos", ajaxdata, function (data) {
			var teacherImg = "img/bodyBg/defined.jpg";
			if (data.Data != "") {
				studentclassid = data.Data[0].id;
				for (var i = 0; i < data.Data.length; i++) {

					textStr = "";

					for (var t = 0; t < data.Data[i]["pinglun_" + data.Data[i].id].length; t++) {
						textStr += '<div class="list"><p id="' + data.Data[i]["pinglun_" + data.Data[i].id][t].id +
							'"><span style="color:#00309e">' + data.Data[i]["pinglun_" + data.Data[i].id][t]
							.username + '</span>：' + data.Data[i]["pinglun_" + data.Data[i].id][t].content +
							'</p>' + '</div>';
						var huifu = data.Data[i]["pinglun_" + data.Data[i].id][t]["huifu_" + data.Data[i][
							"pinglun_" + data.Data[i].id
						][t].id]; //对象-----目前只有一个回复的

						if (huifu.length != 0) {
							for (var j = 0; j < huifu.length; j++) {
								textStr += '<div class="list"><p id="' + data.Data[i]["pinglun_" + data.Data[i].id]
									[t].id + '" index="' + huifu[j].id + '"><span style="color:#00309e">' + huifu[
										j].username + '</span>回复<span class="blue">' + huifu[j].whouserusername +
									'：</span>' + huifu[j].content + '</p>' + '</div>';
							}
						}
					}


				}
				$(".text").html(textStr);
				$(".new_icon").click(function () {
					parent = 0;
					$(".input").show();
					$(".float").show();
					$(".input input").focus();
				})
				$(".text p").click(function () {
					if ($(this).parent(".list").text().indexOf(localStorage.getItem("zhizhao_Name")) ==
						0) {

						return false;
					}
					parent = $(this).attr("id");
					huiparentid = $(this).attr("index");

					$(".input").show();
					$(".float").show();
					$(".input input").focus();
				})
				$(".item").each(function (i) {
					var _this = this;
					$(this)[0].onload = function () {
						$(_this).parent("div").find('.w').text(parseInt($(this).css("width")));
						$(_this).parent("div").find('.h').text(parseInt($(this).css("height")));
					}
				})
				pswpElement = document.querySelectorAll('.pswp')[0];
				options = {
					index: 0 // start at first slide
				};
				gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, options);
				$(".imgLists>div").click(function () {

					items = [];
					var _this = this;

					for (var z = 0; z < $(_this).parent(".imgLists").find(".wrap").length; z++) {
						items.push({
							src: $($(_this).parent(".imgLists").find(".wrap")[z]).find("img").attr(
								"src"),
							w: parseInt($($(_this).parent(".imgLists").find(".wrap")[z]).find(".w")
								.text()),
							h: parseInt($($(_this).parent(".imgLists").find(".wrap")[z]).find(".h")
								.text())
						})
					}
					console.log(items)
					options = {
						index: parseInt($(this).attr("index")) // start at first slide
					};
					gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, options);
					gallery.init();
				})
			} else {
				ui.showToast('暂时没有信息展示哦~');
			}
		})
	}
	$(".main header span").find(".skip").click(function () {
		// location.href = "studyhistry.html?studentId=" + uid + "&children";
		window.location.href = './凤凰币/html/66.html';
	})
	$(".main header span").find("._news").click(function () {
		location.href = "news.html?studentId=" + uid + "&children";
	})

	function showTeacherCard() {
		$(".float").show();
		$(".t_card").show();
	}
	$(".float").click(function () {
		$(this).fadeOut();
		$(".input").hide();
		$(".t_card").fadeOut();
		$(".changeInformation").fadeOut();

	})
	$(".input input").on("input propertychange", function () {
		if ($(this).val() != "") {
			$(".input button").addClass("on");
		} else {
			$(".input button").attr("class", "");
		}
	})

	$(".input button").click(function () {
		if ($(".input input").val() != "") {
			//提交评论
			postAjax(FenghuangConst.hostAjax + "/api/stu/v1/setmodelcomment", JSON.stringify({
				userid: uid,
				studentclassid: studentclassid,
				content: $(".input input").val(),
				type: localStorage.getItem("zhizhao_typle"),
				parent: parent,
				huiparentid: huiparentid
			}), function (data) {
				if (data.Code == 0) {
					ui.showToast('提交成功', 500);
					$(".input input").val("");
					$(".float").click();
					huiparentid = 0;
					go(_curriculumid);
				} else {
					ui.showToast(data.Msg, 500);
				}
			})
		}
	})
</script>

</html>